---
title: "Cart"
jupyter:
  kernelspec:
    display_name: R
    language: R
    name: ir
---

```{r}
install.packages("devtools")
devtools::install_github("alistaire47/read.so")
library(read.so)
```

```{r}
str(Carseats)
```

```{r}
options("scipen"=100, "digits"=4)
if(!require("readr")) install.packages("readr")
if(!require("rpart")) install.packages("rpart")
if(!require("rpart.plot")) install.packages("rpart.plot")
if(!require("ISLR")) install.packages("ISLR")
library("readr")
library("rpart")
library("rpart.plot")
library("ISLR")
```

```{r}
# this is the restaurant data
url<- "https://docs.google.com/spreadsheets/d/e/2PACX-1vQvQ1hQJoj_3BmOV3uLWcDzwIw3GFhkS84NePBS57lnCmXSN86KU8kn4aQUE9rGsxJPMi32S55JBl9w/pub?gid=0&single=true&output=csv"
# this is the purchased data
# url<-"https://docs.google.com/spreadsheets/d/e/2PACX-1vTx21HIv4xKL2c94OLQzMiNPmv5YXw-vAy3dRBL0gnknSMKMK4Ur_4nYGGyDtvS20iU3_r-_zZfQQmj/pub?gid=0&single=true&output=csv"
df<-read.csv(url, stringsAsFactor=TRUE)
```

```{r}
write.so(df)
```

```{r}
str(df)
head(df)
print(df)
```

```{r}
model <- rpart(Purchased~., data=df, method="class", control = rpart.control(minsplit=1,maxdepth=4))
rpart.plot(model)
```

| Salary | Age | Purchased |
|--------|-----|-----------|
| 53700  | 41  | no        |
| 65300  | 37  | no        |
| 48900  | 45  | yes       |
| 64800  | 49  | yes       |
| 44200  | 30  | no        |
| 55900  | 57  | yes       |
| 48600  | 26  | no        |
| 72000  | 60  | yes       |
| 45300  | 34  | no        |
| 73200  | 52  | yes       |

```{r}

Salary<-c(53700,65300,48900,64800,44200,55900,48600,72000,45300,73200)
Age<-c(41,37,45,49,30,57,26,60,34,52)
Purchased<-c("no","no","yes","yes","no","yes","no","yes","no","yes")

purchased_df <- data.frame(Salary, Age, Purchased)
str(purchased_df)
purchased_model <- rpart(Purchased~., data=purchased_df, method="class", control = rpart.control(minsplit=1,maxdepth=4))
rpart.plot(purchased_model)
```

```{r}
str(Carseats)
High = ifelse(Carseats$Sales<=8, "Low", "High")
head(High)
carseats = data.frame(Carseats, High)
str(carseats)
control <- rpart.control(maxdepth=20)
carseats_model <- rpart(High~.-Sales, data=carseats, method="class", control=control)
rpart.plot(carseats_model)
```
