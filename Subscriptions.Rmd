---
title: "Subscriptions"
jupyter:
  kernelspec:
    display_name: R
    language: R
    name: ir
---

```{r, include=FALSE}
blanks<-TRUE
solution<-FALSE
```

```{r}
options(repr.plot.width=4, repr.plot.height=4)
options("scipen"=100, "digits"=4)
```

Create a dataframe for this data showing reported and actual subscriptions in thousands for some magazines:


| Magazine | Reported | Actual |
|------------|---------------------|-------------------|
| YM | 621 | 299.6 |
| CosmoGirl | 359.7 | 207.7 |
| Rosie | 530 | 325 |
| Esquire | 70.5 | 48.6 |
| TeenPeople | 567 | 400.3 |
| More | 125.5 | 91.2 |
| Spin | 50.6 | 39.1 |
| Vogue | 353.3 | 268.6 |
| Elle | 263.6 | 214.3 |

This data shows the reported annual subscriptions (in thousands) for several magazines and the real actual number of subscriptions (also in thousands). It turns out that magazines regularly inflate the numbers when reporting subscriptions, and will report more subscribers than they actually have usually. 

Run a regression analysis to find out if it is possible to predict the actual subscriptions from the reported ones.

First create vectors for the reported and actual subscriber numbers:


```{r, eval=FALSE, include=blanks}
PUT CODE HERE
```
```{r, include=solution}
reported <- c(621,359.7,530,70.5,567,125.5,50.6,353.3,263.6)
actual <- c(299.6, 207.7,325,48.6,400.3,91.2,39.1,268.6,214.3)
```

Next create a data frame for this data. Print out the data frame:

```{r, eval=FALSE, include=blanks}
PUT CODE HERE
```
```{r, include=solution}
df<-data.frame(reported, actual)
df
```

Plot the data by using the `plot` function:

```{r, eval=FALSE, include=blanks}
PUT CODE HERE
```
```{r, include=solution}
plot(df)
```

Give the plot a title (call it "Actual vs Reported Subscriptions") and label the x and y axes using "Reported(000s)" for the x-axis and "Actual(000s)" for the y-axis:

```{r, eval=FALSE, include=blanks}
PUT CODE HERE
```
```{r, include=solution}
plot(df, main="Actual vs Reported Subscriptions", xlab="Reported(000s)", ylab="Actual(000s)", pch=19)
```

The correlation using the `cor` function. The first argument to it will be the reported cololumn of your data frame, the second argument should be the actual column of your data frame

```{r, eval=FALSE, include=blanks}
PUT CODE HERE
```
```{r, include=solution}
R = cor(df$reported,df$actual)
R
```

Next call `lm` and see if you can predict "actual" from "reported"

```{r, eval=FALSE, include=blanks}
PUT CODE HERE
```
```{r, include=solution}
model = lm(actual~reported, data=df)
summary(model)
```

Fill in the following output:

What is the p-value for the overall significance of a linear relationship:

$$ \text{p-value} = ??? $$

The regression equation is this:

$$ actual = m(reported) +b $$   
    
The standard error is:

$$ \text{standard error} = ???  $$ 

Finally using plot again, and abline add the line to the scatterplot: 

```{r, eval=FALSE, include=blanks}
PUT CODE HERE
```
```{r, include=solution}
plot(df, main="Actual vs Reported Subscriptions", xlab="Reported(000s)", ylab="Actual(000s)", pch=19)
abline(model)
```

Suppose we want to do some predictions when the reported subscriptions are 
100,000, 200,000 and 500,000.

Create a data frame for these 3 values and call the `predict` function using your model from above. Print out your predictions for these values. 


```{r, eval=FALSE, include=blanks}
PUT CODE HERE
```

```{r, include=solution}
predictors = data.frame(reported=c(100,200,500))
predictions<-predict(model, predictors)
predictions
```
