---
title: "KMeans"
jupyter:
  kernelspec:
    display_name: R
    language: R
    name: ir
---

```{r echo=T, results='hide', message=F, warning=F}
options("scipen"=100, "digits"=4)
if(!require("readr")) install.packages("readr")
if(!require("Metrics")) install.packages("Metrics")
library("Metrics")
library("readr")
```

This simple example is taken from [KMeans Clustering](https://www.guru99.com/r-k-means-clustering.html)

Suppose we have the age of some customers and the amount they spent on an online retail website for a month. Can we get an idea of what kinds of groups we have here?

```{r}
age = c(18, 21, 22, 24, 26, 26, 27, 30, 31, 35, 39, 40, 41, 42, 44, 46, 47, 48, 49, 54)
spent= c(10, 11, 22, 15, 12, 13, 14, 33, 39, 37, 44, 27, 29, 20, 28, 21, 30, 31, 23, 24)
df <- data.frame(age = age, spent=spent)
```

Plot the data:

```{r}
plot(age, spent, pch=19)
summary(df)
```

```{r}
dataFrame <- data.frame(age=age, spent=spent)
set.seed(2)
clusters<-kmeans(dataFrame,3, nstart=20)
```

```{r}
clusters$centers
```

```{r}
clusters$cluster
plot(dataFrame, col=clusters$cluster, pch=19)
points(clusters$centers, pch=19, col="blue")
```

Basically we can see are 3 groups of customers:

1. Those that are younger and spend less
1. Those that are middle age and spend more 
1. Those that are older age and spend less

